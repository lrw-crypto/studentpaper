<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中學生小論文自動排版系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .loading { display: none; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-blue-800 text-white shadow-lg">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <i class="fas fa-graduation-cap text-2xl"></i>
                <span class="text-xl font-bold tracking-wider">小論文格式救星</span>
            </div>
            <div class="text-sm opacity-80">符合全國高級中等學校競賽標準</div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-10">
        <div class="max-w-2xl mx-auto bg-white rounded-xl shadow-md overflow-hidden">
            <div class="p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">自動格式化工具</h2>
                <p class="text-gray-600 mb-8">上傳您的 Word 草稿，系統將自動調整邊界、字型、頁首尾與標題縮排，並處理參考文獻的懸掛縮排。</p>

                <form action="/upload" method="POST" enctype="multipart/form-data" class="space-y-6" id="uploadForm">
                    
                    <!-- Title Input -->
                    <div>
                        <label for="title" class="block text-sm font-medium text-gray-700 mb-1">小論文篇名 (將用於頁首)</label>
                        <input type="text" name="title" id="title" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                            placeholder="例如：探討AI對高中生學習之影響">
                    </div>

                    <!-- File Upload Area -->
                    <div class="flex items-center justify-center w-full">
                        <label for="file-upload" class="flex flex-col items-center justify-center w-full h-48 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition">
                            <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-3"></i>
                                <p class="mb-2 text-sm text-gray-500"><span class="font-semibold">點擊上傳</span> 或拖曳檔案至此</p>
                                <p class="text-xs text-gray-500">限 .docx 格式 (Word)</p>
                                <p class="mt-2 text-blue-600 font-medium" id="filename-display"></p>
                            </div>
                            <input id="file-upload" name="file" type="file" class="hidden" accept=".docx" required />
                        </label>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-200 flex justify-center items-center">
                        <span id="btn-text">開始排版並下載</span>
                        <i class="fas fa-spinner fa-spin ml-2 loading" id="loading-icon"></i>
                    </button>
                </form>
            </div>
            
            <!-- Features List -->
            <div class="bg-blue-50 px-8 py-6 border-t border-blue-100">
                <h3 class="text-sm font-semibold text-blue-800 uppercase tracking-wide mb-3">系統自動處理項目：</h3>
                <ul class="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-700">
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> 設定版面邊界 (2cm)</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> 內文新細明體 12pt</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> 英文 Times New Roman</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> 自動產生頁首篇名</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> 自動插入頁碼 (置中)</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> 參考文獻 APA 懸掛縮排</li>
                </ul>
            </div>
        </div>
        
        <div class="text-center mt-8 text-gray-400 text-sm">
            <p>注意：排版後請務必人工再次校對，圖片與表格位置可能需微調。</p>
        </div>
    </main>

    <script>
        const fileInput = document.getElementById('file-upload');
        const filenameDisplay = document.getElementById('filename-display');
        const form = document.getElementById('uploadForm');
        const btnText = document.getElementById('btn-text');
        const loadingIcon = document.getElementById('loading-icon');

        fileInput.addEventListener('change', function(e) {
            if (this.files && this.files[0]) {
                filenameDisplay.textContent = this.files[0].name;
            }
        });

        form.addEventListener('submit', function() {
            btnText.textContent = '處理中...';
            loadingIcon.style.display = 'inline-block';
            // 稍微延遲讓下載開始後恢復按鈕，實際應用可用 fetch 處理
            setTimeout(() => {
                btnText.textContent = '排版完成！即將下載';
                loadingIcon.style.display = 'none';
                setTimeout(() => {
                    btnText.textContent = '開始排版並下載';
                }, 3000);
            }, 2000);
        });
    </script>
</body>
</html>